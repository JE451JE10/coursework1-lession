<!DOCTYPE html>
<html>

<head>
    <title>Lessons</title>
    <script src="https://unpkg.com/vue"></script>
    <script src="lessons.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css">
    <meta charset="UTF-8">
</head>

<body>
    <div>
        <div id="app">

            <header>
                <div>
                    <div>
                        <h1 v-text="sitename"></h1>
                        <button v-on:click='showCheckout'>{{cartItemCount}}<span class="fas fa-shopping-cart"></span>Checkout</button>
            </header>


            <main>
                <div v-if="showProduct">
                    <div v-for="lessons in lessons" style="border: 5px solid blue; width: 150px;">
                        <figure>
                            <img v-bind:src="lessons.image" width="100px">
                        </figure>
                        <p>Subject: {{lessons.Subject}}</p>
                        <p>Localtion: {{lessons.Location}}</p>
                        <p>Price: {{lessons.price}}</p>
                        <button v-on:click="addToCart(lessons)" v-if="canAddToCart(lessons)"><span class="fas fa-cart-plus"></span>Add to Cart</button>
                        <button disabled="true" v-else><span class="fas fa-cart-plus"></span>Add to Cart</button>
                        <span v-if="lessons.Space - cartCount(lessons.id) === 0">All Out!</span>
                        <span v-else-if="lessons.Space - cartCount(lessons.id) < 5">Only
                            {{lessons.Space - cartCount(lessons.id)}} left!</span>
                        <span v-else>Buy Now!</span>
                    </div>
                </div>
                <div v-else>
                    <h1>Checkout</h1>
                    <p><strong>First Name:</strong>
                        <input v-model="order.Name" /></p>
                    <p><strong>Last Name:</strong>
                        <input v-model.number="order.Phonenumber" />
                    </p>
                    <h2>Order Information</h2>
                    <p>Name: {{order.Name}}</p>
                    <p>Phone number: {{order.Phonenumber}}</p>

                </div>
            </main>



            <script>
                var app = new Vue({
                    el: '#app',
                    data: {
                        sitename: "Lessons",
                        showProduct: true,
                        a: false,
                        order: {
                            Name: '',
                            Phonenumber: '',
                        },
                        lessons: lessons,
                        cart: []
                    },
                    methods: {
                        addToCart(lessons) {
                            this.cart.push(lessons.id);
                        },
                        showCheckout() {
                            this.showProduct = this.showProduct ? false : true;
                        },

                        canAddToCart(lessons) {
                            return lessons.Space > this.cartCount(lessons.id);
                        },
                        cartCount(id) {
                            let count = 0;
                            for (var i = 0; i < this.cart.length; i++) {
                                if (this.cart[i] === id) {
                                    count++;
                                }
                            }
                            return count;
                        }
                    },
                    computed: {
                        cartItemCount() {
                            return this.cart.length || '';
                        },
                        // sortedlessons() {

                        // }
                    },
                });
            </script>
</body>
</html>
